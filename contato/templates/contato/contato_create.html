{% extends 'base.html' %}

{% load static %}

{% load widget_tweaks %}

{% block content %}

<div class="container">
        
    <!-- Sticky navegation -->
    <div class="row ">
        <div class="col">
            <ol class="breadcrumb mb-4">
                <li class="breadcrumb-item"><a href="index.html">Dashboard</a></li>
                <li class="breadcrumb-item active">Static Navigation</li>
            </ol>
        </div>
    </div>

    <!-- Formulario -->
    <div class="form">
        <form action="" method="post">
            {% csrf_token %}
            <!-- Botões -->
            <div class="row">'
                <div class="col">
                    <div class="button">
                        <button type="submit" class="btn btn-primary">Salvar</button>
                        <button type="button" class="btn btn-secondary">Descartar</button>
                    </div>
                </div>
            </div>


            <!-- Tipo de contato -->
            <div class="row mt-5">
                <div class="col-6">
                    <!-- Tipo de contato - Particular - inline 1 -->
                        {% for radio in form.tipo_contato %}
                            {{ radio.tag }}
                            {{ radio.choice_label }}
                        {% endfor %}
                </div>
            </div>

            <!-- Nome ou Razão social / imagem -->
            <div class="row mt-4">
                <div class="col-6">
                    <div class="form-group">
                        {% render_field form.nome class="form-control form-control-lg bg-light btn-outline-primary" type="text" placeholder="Nome completo ou Razão social" %} 
                            
                    </div>
                </div>
                <div class="col">

                </div>
                <div class="col">

                </div>

            </div>

            <!-- Apelido ou Nome Fantasia / cpf ou cnpj -->
            <div class="row">
                <div class="col-6">
                    <div class="form-group">
                        {% render_field form.apelido type="text" class="form-control" id="" placeholder="Apelido ou Nome fantasia"%}
                    </div>
                </div>
                <div class="col-6">

                    <div class="form-group">
                        {% render_field form.inscricao_federal type="text" class="form-control" placeholder="cpf ou cnpj" id="" %}
                    </div>

                </div>

            </div>

            <!-- Contatp / Marcadores -->
            <div class="row">
                <div class="col-6">
                    <div class="form-group">
                        <!-- https://developer.snapappointments.com/bootstrap-select/examples/ -->
                        <select class="selectpicker w-100" data-dropup-auto="false" data-size="4"
                            data-live-search="true" title="Contato ou Empresa">
                            <option>1</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                        </select>
                    </div>
                </div>
                <div class="col-6">
                    <div class="form-group">
                        <!-- Multiselect dropdown -->
                        <select multiple class="selectpicker w-100" data-dropup-auto="false" data-size="4"
                            data-live-search="true" title="Marcadores">
                            <option data-content="<span class='badge badge-secondary'>1</span>">1</option>
                            <option data-content="<span class='badge badge-secondary'>2</span>">2</option>
                            <option data-content="<span class='badge badge-secondary'>3</span>">4</option>
                            <option data-content="<span class='badge badge-secondary'>4</span>">5</option>
                            <option data-content="<span class='badge badge-secondary'>5</span>">6</option>
                            <option data-content="<span class='badge badge-secondary'>6</span>">7</option>
                            <option data-content="<span class='badge badge-secondary'>7</span>">8</option>
                        </select><!-- End -->
                    </div>

                </div>
            </div>
            
            <div class="row mt-5">
                <div class="col-sm-6">
                    <div id="linha1" class="row">
                        <div class="col-sm-12">

                            <!-- CEP -->
                            <div class="form-group row">
                                <label for="colFormLabelSm"
                                    class="col-sm-2 col-form-label col-form-label-sm">CEP</label>
                                <div class="col-sm-3">
                                    {% render_field form.cep type="text" class="form-control form-control-sm" id="cep" placeholder="CEP" %}
                                </div>
                            </div>
                            
                            <!-- Logradura Nª -->
                            <div class="form-group row">
                                <label for="colFormLabelSm"
                                    class="col-sm-2 col-form-label col-form-label-sm">Logradouro</label>
                                <div class="col-sm-8">
                                    {% render_field form.logradouro type="text" class="form-control form-control-sm" id="rua" placeholder="Logradura (Ex. Rua...)" %}
                                </div>
                                <div class="col-sm-2">
                                    {% render_field form.numero type="text" class="form-control form-control-sm" id="numero" placeholder="N°" %}
                                </div>
                            </div>

                            <!-- Complemento -->
                            <div class="form-group row">
                                <label for="colFormLabelSm"
                                    class="col-sm-2 col-form-label col-form-label-sm">Complemento</label>
                                <div class="col-sm-10">
                                    {% render_field form.complemento type="text" class="form-control form-control-sm" id="colFormLabelSm" placeholder="Complemento (Ex. Casa no quintal)" %}
                                </div>
                            </div>

                            <!-- Bairro -->
                            <div class="form-group row">
                                <label for="colFormLabelSm"
                                    class="col-sm-2 col-form-label col-form-label-sm">Bairro</label>
                                <div class="col-sm-10">
                                    {% render_field form.bairro type="text" class="form-control form-control-sm" id="bairro" placeholder="Bairro (Ex. Centro)" %}
                                </div>
                            </div>

                            <!-- Cidade UF  -->
                            <div class="form-group row">
                                <label for="colFormLabelSm" class="col-sm-2 col-form-label col-form-label-sm">Cidade
                                    UF</label>
                                <div class="col-sm-7">
                                    {% render_field form.cidade type="text" class="form-control form-control-sm" id="cidade" placeholder="Cidade" %}
                                </div>
                                <div class="col-sm-3">
                                    {% render_field form.uf type="text" class="form-control form-control-sm" id="uf" placeholder="UF" %}
                                </div>
                            </div>

                        </div>
                    </div>
                    <div id="linha2" class="row">
                        <div class="col-sm-12">
                            <!-- Content -->
                            
                        </div>
                    </div>
                </div>

                <div class="col-sm-6">
                    <!-- Cargo -->
                    <div class="form-group row">
                        <label for="colFormLabelSm" class="col-sm-2 col-form-label col-form-label-sm">Cargo</label>
                        <div class="col-sm-10">
                            {% render_field form.cargo type="text" class="form-control form-control-sm" id="colFormLabelSm" placeholder="Cargo (Ex. Direitor)" %}
                        </div>
                    </div>

                    <!-- Telefone -->
                    <div class="form-group row">
                        <label for="colFormLabelSm"
                            class="col-sm-2 col-form-label col-form-label-sm">Telefone</label>
                        <div class="col-sm-10">
                            {% render_field form.telefone type="text" class="form-control form-control-sm" id="colFormLabelSm" placeholder="Nº de telefone (Ex. 92 99999 9999)" %}
                        </div>
                    </div>

                    <!-- Celular -->
                    <div class="form-group row">
                        <label for="colFormLabelSm" class="col-sm-2 col-form-label col-form-label-sm">Celular</label>
                        <div class="col-sm-10">
                            {% render_field form.mobile type="tel" class="form-control form-control-sm" id="colFormLabelSm" placeholder="Nº de celular (Ex. 92 99999 9999)" %}
                        </div>
                    </div>

                    <!-- Celular -->
                    <div class="form-group row">
                        <label for="colFormLabelSm" class="col-sm-2 col-form-label col-form-label-sm">Email</label>
                        <div class="col-sm-10">
                            {% render_field form.email type="email" class="form-control form-control-sm" id="colFormLabelSm" placeholder="Email (Ex. João@gmail.com)" %}
                        </div>
                    </div>

                    <!-- Site -->
                    <div class="form-group row">
                        <label for="colFormLabelSm" class="col-sm-2 col-form-label col-form-label-sm">Site</label>
                        <div class="col-sm-10">
                            {% render_field form.site_web type="url" class="form-control form-control-sm" id="colFormLabelSm" placeholder="Site (Ex. www.meusite.com)" %}
                        </div>
                    </div>

                    <!-- Observações -->
                    <div class="form-group row">
                        <label for="exampleFormControlTextarea1" class="col-sm-2 col-form-label col-form-label-sm">Observações</label>
                        <div class="col-sm-10">
                            {% render_field form.observacao class="form-control" id="exampleFormControlTextarea1" rows="2"> %}
                        </div>
                    </div>

                </div>
            </div>

        </form>
    </div>

</div>
{% endblock content %}

{% block script %}

    <script src="{% static 'js/viacep.js' %}"></script>

    <script>

        $(document).ready(function() {
    
            function limpa_formulário_cep() {
                // Limpa valores do formulário de cep.
                $("#rua").val("");
                $("#bairro").val("");
                $("#cidade").val("");
                $("#uf").val("");
                $("#ibge").val("");
            }
            
            //Quando o campo cep perde o foco.
            $("#cep").blur(function() {
    
                //Nova variável "cep" somente com dígitos.
                var cep = $(this).val().replace(/\D/g, '');
    
                //Verifica se campo cep possui valor informado.
                if (cep != "") {
    
                    //Expressão regular para validar o CEP.
                    var validacep = /^[0-9]{8}$/;
    
                    //Valida o formato do CEP.
                    if(validacep.test(cep)) {
    
                        //Preenche os campos com "..." enquanto consulta webservice.
                        $("#rua").val("...");
                        $("#bairro").val("...");
                        $("#cidade").val("...");
                        $("#uf").val("...");
                        $("#ibge").val("...");
    
                        //Consulta o webservice viacep.com.br/
                        $.getJSON("https://viacep.com.br/ws/"+ cep +"/json/?callback=?", function(dados) {
    
                            if (!("erro" in dados)) {
                                //Atualiza os campos com os valores da consulta.
                                $("#rua").val(dados.logradouro);
                                $("#bairro").val(dados.bairro);
                                $("#cidade").val(dados.localidade);
                                $("#uf").val(dados.uf);
                                $("#ibge").val(dados.ibge);
                            } //end if.
                            else {
                                //CEP pesquisado não foi encontrado.
                                limpa_formulário_cep();
                                alert("CEP não encontrado.");
                            }
                        });
                    } //end if.
                    else {
                        //cep é inválido.
                        limpa_formulário_cep();
                        alert("Formato de CEP inválido.");
                    }
                } //end if.
                else {
                    //cep sem valor, limpa formulário.
                    limpa_formulário_cep();
                }
            });
        });
    
    </script>

{% endblock script %}